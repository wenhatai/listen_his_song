<?php
require_once("class.base.php");

class Friend extends Conn{
	
	function insert($gid, $fopenid){
		$sql = "INSERT INTO friend (gid, fopenid) VALUES (?, ?)";
		$stmt = $this->mysqli->prepare($sql);
		$stmt->bind_param("ss", $gid, $fopenid);
		$stmt->execute();
		$stmt->close();
		$this->uid = $this->mysqli->insert_id;
		return $this->uid;
	}
	
	function findFriendsInGroup($gid){
		$ret = array();
		$sql = "SELECT fopenid FROM friend WHERE gid = ?";
		$stmt = $this->mysqli->prepare($sql);
		$stmt->bind_param("i", $gid);
		$stmt->execute();
		$stmt->bind_result($openid);
		$i = 0;
		while($stmt->fetch()){
			$ret[$i]['openid'] = $openid;
			$i++;
		}
		$stmt->close();
		return $ret;
	}
	
	function removefriend($fid,$gid){
		$sql = "DELETE FROM friend WHERE fopenid=? AND gid=?";
		$stmt = $this->mysqli->prepare($sql);
		$stmt->bind_param("si",$fid,$gid);
		$stmt->execute();
		$stmt->close();
		return true;
	}
}
?>